<div id="menu-main-mobile" class="menu-main-mobile">
    <ul class="menu">
        {{ $currentPage := . }}
        {{ range .Site.Menus.main }}
            {{ $active := or ($currentPage.IsMenuCurrent "main" .) ($currentPage.HasMenuCurrent "main" .) }}
            {{ $active = or $active (eq (.URL | relLangURL) ($currentPage.RelPermalink | relLangURL)) }}
            
            {{/* Специальная логика для кнопок переключения языка */}}
            {{ if or (eq .Identifier "ru") (eq .Identifier "en") }}
              {{ $active = false }}
              {{ if eq .Identifier "ru" }}
                {{ $active = eq $currentPage.Lang "ru" }}
              {{ else if eq .Identifier "en" }}
                {{ $active = eq $currentPage.Lang "en" }}
              {{ end }}
            {{ end }}
            
            {{ if .HasChildren }}
                <li class="menu-item-{{ .Name | lower }}{{ if $active }} active{{ end }}">
                    <a href="{{ .URL | absLangURL }}">{{ .Name }}</a>
                    <div class="dropdown">
                        <ul class="sub-menu">
                            {{ range .Children }}
                                <li class="{{ if $currentPage.IsMenuCurrent "main" . }}active{{ end }}">
                                    <a href="{{ .URL | absLangURL }}">{{ .Name }}</a>
                                </li>
                            {{ end }}
                        </ul>
                    </div>
                </li>
            {{else}}
                <li class="menu-item-{{ .Name | lower }}{{ if $active }} active{{ end }}">
                    <a href="{{ .URL | absLangURL }}">{{ .Name }}</a>
                </li>
            {{end}}
        {{end}}
    </ul>
</div>
